<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>モンスター弱点早見表</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      font-size: 1.5em;
      background-color: #f9f9f9;
    }
    h1 {
      text-align: center;
      margin: 0;
      padding: 0.5em 0;
    }
    table {
      width: 95%;
      margin: 20px auto;
      border-collapse: separate;
      border-spacing: 0;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
      overflow: visible;
      table-layout: fixed;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 12px 15px;
      text-align: center;
      vertical-align: middle;
    }

    thead th {
      font-weight: 600;
      position: sticky;
      background-color: #eee;
      top: 0;
      z-index: 2;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    /* colgroup で各列の幅を指定 */
    col.monster-col { width: 32%; }
    col.attr-col { width: 13%; }
    
    /* モンスター画像 */
    .monster-img {
      width: 95px;
      height: auto;
    }
    /* 属性画像 */
    .attribute-img {
      width: 60px;
      height: auto;
      vertical-align: middle;
    }
    /* 弱点画像 */
    .weakness-img {
      width: 60px;
      height: auto;
    }
    /* ヘッダー内のラベル */
    .header-label {
      display: inline-block;
      vertical-align: middle;
    }
    /* ヘッダー内検索フォーム */
    .header-search-container {
      display: block;
      margin-top: 2px;
      font-size: 30px;
    }
    .header-search-container input {
      width: 75%;
      padding: 2px 15px;
      font-size: 1.35em;
      border-radius: 30px;
    }
    .sort-indicator {
      display: inline-block;
      vertical-align: middle;
      margin-left: 1px;
    }
    .sort-indicator .sort-up,
    .sort-indicator .sort-down {
      display: block;
      font-size: 0.5em;
      line-height: 1;
      color: grey;
    }
    /* モーダル背景 */
    .modal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: flex;             /* クリック時にflexになる */
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    /* モーダルコンテンツ */
    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 8px;
      /* 横幅をやや大きめに */
      width: 80%;
      max-width: 900px;  /* 必要に応じて拡大 */
      /* 縦を1.5倍程度にしてスクロールできるように */
      height: 70vh;  /* 必要に応じて 80vh などに変更 */
      overflow-y: auto;
      position: relative;
    }
    /* 閉じるボタン */
    .close-button {
      position: absolute;
      top: 10px; 
      right: 15px;
      font-size: 1.5em;
      cursor: pointer;
    }
    /* ポップアップ内テーブルの例 */
    .detail-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    .detail-table th, .detail-table td {
      border: 1px solid #ccc;
      padding: 8px 12px;
      text-align: center;
    }
    .detail-table caption {
      font-weight: bold;
      margin-bottom: 5px;
    }
  </style>
</head>
<body>
  <h1>モンスター弱点早見表</h1>
  <table>
    <colgroup>
      <col class="monster-col">
      <col class="attr-col">
      <col class="attr-col">
      <col class="attr-col">
      <col class="attr-col">
      <col class="attr-col">
    </colgroup>
    <thead>
      <tr>
        <th data-sort="name">
          <div class="header-label">
            モンスター 
            <span class="sort-indicator">
              <span class="sort-up">&#9650;</span>
              <span class="sort-down">&#9660;</span>
            </span>
          </div>
          <div class="header-search-container">
            <input type="text" id="monsterSearch" placeholder="Search" onclick="event.stopPropagation()">
          </div>
        </th>
        <th data-sort="fire">
          <img src="images/fire.png" alt="火属性" class="attribute-img">
          <br>火属性
          <span class="sort-indicator">
            <span class="sort-up">&#9650;</span>
            <span class="sort-down">&#9660;</span>
          </span>
        </th>
        <th data-sort="water">
          <img src="images/water.png" alt="水属性" class="attribute-img">
          <br>水属性
            <span class="sort-indicator">
            <span class="sort-up">&#9650;</span>
            <span class="sort-down">&#9660;</span>
          </span>
        </th>
        <th data-sort="thunder">
          <img src="images/thunder.png" alt="雷属性" class="attribute-img">
          <br>雷属性
          <span class="sort-indicator">
            <span class="sort-up">&#9650;</span>
            <span class="sort-down">&#9660;</span>
          </span>
        </th>
        <th data-sort="ice">
          <img src="images/ice.png" alt="氷属性" class="attribute-img">
          <br>氷属性
          <span class="sort-indicator">
            <span class="sort-up">&#9650;</span>
            <span class="sort-down">&#9660;</span>
          </span>
        </th>
        <th data-sort="dragon">
          <img src="images/dragon.png" alt="龍属性" class="attribute-img">
          <br>龍属性
          <span class="sort-indicator">
            <span class="sort-up">&#9650;</span>
            <span class="sort-down">&#9660;</span>
          </span>
        </th>
      </tr>
    </thead>
    <tbody>
      <!-- JavaScript により行が動的に生成される -->
    </tbody>
  </table>
  <div id="monsterModal" class="modal" style="display:none;">
    <div class="modal-content">
      <span class="close-button">&times;</span>
      <h2 id="modalMonsterName">モンスター名</h2>
      <div id="modalDetails">詳細情報</div>
    </div>
  </div>

  <script>
    // モンスター情報のデータ配列
    const monsters = [
      {
        name: "チャタカブラ",
        yomi: "ちゃたかぶら",
        image: "images/chatakabra.png",
        weaknesses: { fire: "✧1", water: "✧1", thunder: "✧2", ice: "✧1", dragon: "✕" },
        parts: {
          頭: {slash: "◎", blunt: "◎", shot: "◎",
            fire: "△", water: "△", thunder: "◯", ice: "△", dragon: "×"
          },
          舌: {slash: "◎", blunt: "◎", shot: "◎",
            fire: "△", water: "△", thunder: "◯", ice: "△", dragon: "×"
          },
          胴: {slash: "◯", blunt: "◯", shot: "◯",
            fire: "△", water: "△", thunder: "◯", ice: "△", dragon: "×"
          },
          左前脚: {slash: "◎", blunt: "◎", shot: "◎",
            fire: "△", water: "△", thunder: "△", ice: "△", dragon: "×"
          },
          右前脚: {slash: "◎", blunt: "◎", shot: "◎",
            fire: "△", water: "△", thunder: "△", ice: "△", dragon: "×"
          },
          左後脚: {slash: "◎", blunt: "◎", shot: "◎",
            fire: "×", water: "×", thunder: "◯", ice: "△", dragon: "×"
          },
          右後脚: {slash: "◎", blunt: "◎", shot: "◎",
            fire: "×", water: "×", thunder: "◯", ice: "△", dragon: "×"
          },
          尻: {slash: "◯", blunt: "◯", shot: "◯",
            fire: "△", water: "△", thunder: "◯", ice: "△", dragon: "×"
          }
        },
        weak: { poison: "◎", paralysis: "◎", sleep: "◯", explosion: "◯", faint: "◎" }
      },
      {
        name: "ケマトリス",
        yomi: "けまとりす",
        image: "images/kematorisu.png",
        weaknesses: { fire: "✕", water: "✧2", thunder: "✧1", ice: "✧1", dragon: "✧1" },
        parts: {
          頭: {slash: "◎", blunt: "◎", shot: "◎",
            fire: "×", water: "◯", thunder: "△", ice: "△", dragon: "△"
          },
          胴: {slash: "◯", blunt: "◯", shot: "△",
            fire: "×", water: "△", thunder: "△", ice: "△", dragon: "△"
          },
          左前脚: {slash: "◯", blunt: "△", shot: "△",
            fire: "×", water: "△", thunder: "△", ice: "△", dragon: "△"
          },
          右前脚: {slash: "◯", blunt: "△", shot: "△",
            fire: "×", water: "△", thunder: "△", ice: "△", dragon: "△"
          },
          左後脚: {slash: "◯", blunt: "△", shot: "△",
            fire: "×", water: "△", thunder: "△", ice: "△", dragon: "△"
          },
          右後脚: {slash: "◯", blunt: "△", shot: "△",
            fire: "×", water: "△", thunder: "△", ice: "△", dragon: "△"
          },
          尻尾: {slash: "◎", blunt: "◎", shot: "◎",
            fire: "×", water: "◯", thunder: "△", ice: "△", dragon: "△"
          }
        },
        weak: { poison: "◯", paralysis: "◯", sleep: "△", explosion: "△", faint: "△" }
      },
      {
        name: "ラバラバリナ",
        yomi: "らばらばりな",
        image: "images/labarabarina.png",
        weaknesses: { fire: "✧2", water: "✕", thunder: "✧1", ice: "✧1", dragon: "✕" },
        parts: {
          頭: {slash: "◯", blunt: "◎", shot: "◯",
            fire: "◯", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          胴: {slash: "◯", blunt: "◯", shot: "△",
            fire: "△", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          左前脚: {slash: "◯", blunt: "◯", shot: "△",
            fire: "△", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          右前脚: {slash: "◯", blunt: "◯", shot: "△",
            fire: "△", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          左爪: {slash: "◯", blunt: "◯", shot: "◯",
            fire: "△", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          右爪: {slash: "◯", blunt: "◯", shot: "◯",
            fire: "△", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          左後脚: {slash: "◯", blunt: "◯", shot: "△",
            fire: "△", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          右後脚: {slash: "◯", blunt: "◯", shot: "△",
            fire: "△", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          花弁状態: {slash: "◎", blunt: "◎", shot: "◯",
            fire: "◯", water: "×", thunder: "△", ice: "△", dragon: "×"
          },
          尻尾: {slash: "◎", blunt: "◎", shot: "◯",
            fire: "◯", water: "×", thunder: "△", ice: "△", dragon: "×"
          }
        },
        weak: { poison: "◯", paralysis: "△", sleep: "◯", explosion: "◯", faint: "◎" }
      },
      {
        name: "ババコンガ",
        yomi: "ばばこんが",
        image: "images/babakonga.png",
        weaknesses: { fire: "✧2", water: "✧1", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "バーラハーラ",
        yomi: "ばーらはーら",
        image: "images/barahara.png",
        weaknesses: { fire: "✧1", water: "✕", thunder: "✧2", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "ドシャグマ",
        yomi: "どしゃぐま",
        image: "images/doshaguma.png",
        weaknesses: { fire: "✧2", water: "✧1", thunder: "✧2", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "ウズトゥナ",
        yomi: "うずとぅな",
        image: "images/uztuna.png",
        weaknesses: { fire: "✧1", water: "✕", thunder: "✧2", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "ププロポル",
        yomi: "ぷぷろぽる",
        image: "images/ppupororu.png",
        weaknesses: { fire: "✧1", water: "✧2", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "レダウ",
        yomi: "れだう",
        image: "images/redau.png",
        weaknesses: { fire: "✧1", water: "✧1", thunder: "✕", ice: "✧2", dragon: "✧1" }
      },
      {
        name: "ネルスキュラ",
        yomi: "ねるすきゅら",
        image: "images/nerusukyura.png",
        weaknesses: { fire: "✧2", water: "✕", thunder: "✧1", ice: "✧1", dragon: "✕" }
      },
      {
        name: "ヒラバミ",
        yomi: "ひらばみ",
        image: "images/hirabami.png",
        weaknesses: { fire: "✧2", water: "✧1", thunder: "✧2", ice: "✕", dragon: "✧1" }
      },
      {
        name: "アジャラカン",
        yomi: "あじゃらかん",
        image: "images/ajarakank.png",
        weaknesses: { fire: "✕", water: "✧2", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "ヌエグドラ",
        yomi: "ぬえぐどら",
        image: "images/nuegudora.png",
        weaknesses: { fire: "✕", water: "✧2", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "護竜ドシャグマ",
        yomi: "ごりゅうどしゃぐま",
        image: "images/guardian_doshaguma.png",
        weaknesses: { fire: "✧2", water: "✧1", thunder: "✧2", ice: "✧2", dragon: "✧2" }
      },
      {
        name: "護竜リオレウス",
        yomi: "ごりゅうりおれうす",
        image: "images/guardian_rioreus.png",
        weaknesses: { fire: "✕", water: "✧1", thunder: "✧2", ice: "✧1", dragon: "✧2" }
      },
      {
        name: "護竜アルシュベルド",
        yomi: "ごりゅうあるしゅべるど",
        image: "images/guardian_alshubeld.png",
        weaknesses: { fire: "✧1", water: "✧1", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "ジンダハド",
        yomi: "じんだはど",
        image: "images/jindahad.png",
        weaknesses: { fire: "✧2", water: "✧1", thunder: "✧1", ice: "✕", dragon: "✧1" }
      },
      {
        name: "護竜オドガロン亜種",
        yomi: "ごりゅうおどがろんあしゅ",
        image: "images/guardian_odogaron.png",
        weaknesses: { fire: "✧1", water: "✧2", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "シーウー",
        yomi: "しーうー",
        image: "images/siu.png",
        weaknesses: { fire: "✧1", water: "✧1", thunder: "✧1", ice: "✧2", dragon: "✕" }
      },
      {
        name: "ゾシア",
        yomi: "ぞしあ",
        image: "images/zoshia.png",
        weaknesses: { fire: "✧1", water: "✧1", thunder: "✧1", ice: "✧1", dragon: "✧2" }
      },
      {
        name: "イャンクック",
        yomi: "いゃんくっく",
        image: "images/yankukku.png",
        weaknesses: { fire: "✧1", water: "✧1", thunder: "✧2", ice: "✧2", dragon: "✕" }
      },
      {
        name: "ゲリョス",
        yomi: "げりょす",
        image: "images/geryos.png",
        weaknesses: { fire: "✧2", water: "✧1", thunder: "✕", ice: "✧2", dragon: "✧1" }
      },
      {
        name: "リオレウス",
        yomi: "りおれうす",
        image: "images/rioreus.png",
        weaknesses: { fire: "✕", water: "✧1", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "リオレイア",
        yomi: "りおれいあ",
        image: "images/rioreia.png",
        weaknesses: { fire: "✕", water: "✧1", thunder: "✧1", ice: "✧1", dragon: "✧2" }
      },
      {
        name: "グラビモス",
        yomi: "ぐらびもす",
        image: "images/gurabimosu.png",
        weaknesses: { fire: "✕", water: "✧2", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      },
      {
        name: "ドドブランゴ",
        yomi: "どどぶらんご",
        image: "images/dodoburango.png",
        weaknesses: { fire: "✧2", water: "✧1", thunder: "✧1", ice: "✧1", dragon: "✕" }
      },
      {
        name: "護竜アンジャナフ亜種",
        yomi: "ごりゅうあんじゃなふあしゅ",
        image: "images/guardian_anjanafu.png",
        weaknesses: { fire: "✧1", water: "✧1", thunder: "✕", ice: "✧2", dragon: "✧1" }
      },
      {
        name: "ゴアマガラ",
        yomi: "ごあまがら",
        image: "images/goa_magara.png",
        weaknesses: { fire: "✧2", water: "✧1", thunder: "✧1", ice: "✧1", dragon: "✧2" }
      },
      {
        name: "アルシュベルド",
        yomi: "あるしゅべるど",
        image: "images/alshubeld.png",
        weaknesses: { fire: "✧1", water: "✧1", thunder: "✧1", ice: "✧1", dragon: "✧1" }
      }
    ];
    
    let currentSortColumn = null;
    let currentSortOrder = 1;
    
    function renderTable(data) {
      const tbody = document.querySelector("table tbody");
      tbody.innerHTML = "";
      data.forEach(monster => {
        const tr = document.createElement("tr");
        const tdName = document.createElement("td");
        const img = document.createElement("img");
        img.src = monster.image;
        img.alt = monster.name;
        img.className = "monster-img";
        tdName.appendChild(img);
        tdName.appendChild(document.createElement("br"));
        tdName.appendChild(document.createTextNode(monster.name));
        tr.appendChild(tdName);
        
        const attributes = ["fire", "water", "thunder", "ice", "dragon"];
        attributes.forEach(attr => {
          const td = document.createElement("td");
          const weakImg = document.createElement("img");
          let weakVal = monster.weaknesses[attr];
          if (weakVal === "✧1") {
            weakImg.src = "images/weakness_x1.png";
          } else if (weakVal === "✧2") {
            weakImg.src = "images/weakness_x2.png";
          } else {
            weakImg.src = "images/weakness_x.png";
          }
          weakImg.alt = weakVal;
          weakImg.className = "weakness-img";
          td.appendChild(weakImg);
          tr.appendChild(td);
        });
        tr.addEventListener("click", () => {
        // モンスター名
        document.getElementById("modalMonsterName").textContent = monster.name;

        let partsRows = "";
        for (const partName in monster.parts) {
          const part = monster.parts[partName];
          partsRows += `
            <tr>
              <td class="nowrap">${partName}</td>
              <td>${part.slash || "-"}</td>
              <td>${part.blunt || "-"}</td>
              <td>${part.shot || "-"}</td>
              <td>${part.fire || "-"}</td>
              <td>${part.water || "-"}</td>
              <td>${part.thunder || "-"}</td>
              <td>${part.ice || "-"}</td>
              <td>${part.dragon || "-"}</td>
            </tr>
          `;
        }        
        // 「弱点・肉質・耐性」セクションの例
        const detailsHTML = `        
          <!-- 各部位への効きやすさ（テーブル） -->
          <table class="detail-table">
            <caption>各部位への効きやすさ</caption>
            <thead>
              <tr>
                <th width="90">部位</th>
                <th>斬</th>
                <th>打</th>
                <th>弾</th>
                <th>火</th>
                <th>水</th>
                <th>雷</th>
                <th>氷</th>
                <th>龍</th>
              </tr>
            </thead>
            <tbody>
              ${partsRows}
            </tbody>
          </table>
          
          <!-- 状態異常耐性（テーブル） -->
          <table class="detail-table">
            <caption>状態異常耐性</caption>
            <thead>
              <tr>
                <th>毒</th>
                <th>麻痺</th>
                <th>睡眠</th>
                <th>爆破</th>
                <th>気絶</th>
              </tr>
            </thead>
            <tbody>
              <!-- 例: 頭 -->
              <tr>
                <td>${monster.weak?.poison || "-"}</td>
                <td>${monster.weak?.paralysis || "-"}</td>
                <td>${monster.weak?.sleep || "-"}</td>
                <td>${monster.weak?.explosion || "-"}</td>
                <td>${monster.weak?.faint || "-"}</td>
              </tr>
              <!-- 必要に応じて他の部位を追加 -->
            </tbody>
          </table>
        `;
        
        // モーダルに反映して表示
        document.getElementById("modalDetails").innerHTML = detailsHTML;
        document.getElementById("monsterModal").style.display = "flex";
      });
          
          tbody.appendChild(tr);
      });
    }

    document.querySelector(".close-button").addEventListener("click", () => {
    document.getElementById("monsterModal").style.display = "none";
  });
    
    function weaknessScore(value) {
      if (value === "✧2") return 2;
      if (value === "✧1") return 1;
      return 0;
    }
    
    function filterAndSort() {
      const rawSearchText = document.getElementById("monsterSearch").value;
      const searchText = rawSearchText.toLowerCase();
      
      let filtered = monsters.filter(monster => {
        return monster.yomi.toLowerCase().includes(searchText) ||
               monster.name.toLowerCase().includes(searchText);
      });
  
      if (currentSortColumn !== null) {
        filtered.sort((a, b) => {
          let result = 0;
          if (currentSortColumn === 0) {
            result = a.yomi.localeCompare(b.yomi);
          } else {
            const attributes = ["fire", "water", "thunder", "ice", "dragon"];
            let attr = attributes[currentSortColumn - 1];
            result = weaknessScore(a.weaknesses[attr]) - weaknessScore(b.weaknesses[attr]);
          }
          return result * currentSortOrder;
        });
      }
      renderTable(filtered);
      updateSortIndicators();
    }
    
    function sortByColumn(colIndex) {
      if (currentSortColumn === colIndex) {
        currentSortOrder = -currentSortOrder;
      } else {
        currentSortColumn = colIndex;
        currentSortOrder = 1;
      }
      filterAndSort();
    }
    
    function updateSortIndicators() {
      const headers = document.querySelectorAll("thead th");
      headers.forEach((th, index) => {
        const sortUp = th.querySelector(".sort-up");
        const sortDown = th.querySelector(".sort-down");
        if (currentSortColumn === index) {
          if (currentSortOrder === 1) {
            sortUp.style.color = "black";
            sortDown.style.color = "grey";
          } else {
            sortUp.style.color = "grey";
            sortDown.style.color = "black";
          }
        } else {
          sortUp.style.color = "grey";
          sortDown.style.color = "grey";
        }
      });
    }
    
    document.getElementById("monsterSearch").addEventListener("input", filterAndSort);
    document.querySelectorAll("thead th").forEach((th, index) => {
      th.style.cursor = "pointer";
      th.addEventListener("click", () => sortByColumn(index));
    });
    
    renderTable(monsters);
  </script>
</body>
</html>
